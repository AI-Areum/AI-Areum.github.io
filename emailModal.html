<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>e-mail Secure Form</title>
  <meta name="description" content="프로젝트/협업 문의를 안전하게 전송하세요.<br> 메일 확인 후 연락드리겠습니다.">
  <meta name="robots" content="noindex,follow">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Plus+Jakarta+Sans:wght@400;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
  <!-- Bootstrap 5.3 & Icons (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    :root{
      --brand:#5D7BFF; --brand-600:#4b64ff; --brand-700:#394fe6;
      --ok:#065f46; --ok-bg:#ecfdf5; --ok-bd:#10b981;
      --ng:#991b1b; --ng-bg:#fef2f2; --ng-bd:#ef4444;
      --ring:#4b64ff;
    }
    body{
      font-family:"Plus Jakarta Sans","Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background:
        radial-gradient(1200px 700px at 10% -10%, rgba(93,123,255,.08), transparent 60%),
        radial-gradient(900px 600px at 110% 10%, rgba(120,169,255,.06), transparent 55%),
        #f6f8fb;
    }
    .card{
      border:1px solid rgba(15,23,42,.06);
      box-shadow:0 20px 40px rgba(16,24,40,.08), 0 8px 16px rgba(16,24,40,.06);
      border-radius:16px;
      overflow:hidden;
    }
    .card-header{
      background:linear-gradient(135deg,#5D7BFF 0%,#78A9FF 60%,#6b86ff 100%);
      color:#fff;
    }
    .card-header h1{
      font-family:"Playfair Display",serif;
      letter-spacing:.2px;
    }
    .form-label{font-weight:700}
    .form-control:focus, .form-select:focus, textarea:focus{
      border-color:var(--ring)!important;
      box-shadow:0 0 0 .25rem rgba(75,100,255,.25)!important;
    }
    .is-invalid{border-color:var(--ng-bd)!important}
    .invalid-feedback{font-size:.9rem}
    .alert-wrap .alert{margin-bottom:0}
    .honeypot{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    .btn-primary{
      background:var(--brand); border-color:var(--brand);
    }
    .btn-primary:hover{background:var(--brand-600); border-color:var(--brand-600)}
    .btn-primary:active{background:var(--brand-700)!important; border-color:var(--brand-700)!important}
    @media (prefers-color-scheme: dark){
      body{background:#0b1220}
      .card{border-color:rgba(255,255,255,.06)}
      .card-header{background:linear-gradient(135deg,#7d8dff 0%,#9aa6ff 60%,#6c7cff 100%)}
    }
  </style>
</head>
<body class="min-vh-100 d-flex align-items-center">
  <div class="container my-4">
    <div class="row justify-content-center">
      <div class="col-12 col-md-10 col-lg-8">
        <div class="card">
          <div class="card-header p-4">
            <h1 class="h3 mb-2">e-mail Secure Form</h1>
            <p class="mb-0">프로젝트/협업 문의를 안전하게 전송하세요. 메일 확인 후 연락드리겠습니다.</p>
          </div>

          <div class="card-body p-4">
            <!-- Alerts -->
            <div class="alert-wrap mb-3" aria-live="assertive" aria-atomic="true">
              <div id="liveAlert" class="alert d-none" role="alert"></div>
            </div>

            <!-- Form -->
            <form id="secureForm" class="needs-validation" action="https://formspree.io/f/xnnbodjr" method="POST" novalidate>
              <!-- hidden ops -->
              <input type="hidden" name="_subject" value="Portfolio Contact — AI-Areum (Bootstrap)">
              <input type="hidden" name="form_name" value="ai-areum-contact-bootstrap">
              <input type="hidden" name="source" value="">
              <input type="hidden" name="ts" value="">
              <input type="text" name="_gotcha" class="honeypot" tabindex="-1" autocomplete="off" aria-hidden="true">

              <div class="mb-3">
                <label for="name" class="form-label"><i class="bi bi-person me-2" aria-hidden="true"></i>이름</label>
                <input type="text" class="form-control" id="name" name="name" autocomplete="name" required aria-describedby="nameHelp">
                <div id="nameHelp" class="invalid-feedback">이름을 입력하세요.</div>
              </div>

              <div class="mb-3">
                <label for="email" class="form-label"><i class="bi bi-at me-2" aria-hidden="true"></i>이메일</label>
                <input type="email" class="form-control" id="email" name="email" inputmode="email" autocomplete="email" required aria-describedby="emailHelp">
                <div id="emailHelp" class="invalid-feedback">올바른 이메일 주소를 입력하세요.</div>
              </div>

              <div class="mb-3">
                <label for="category" class="form-label"><i class="bi bi-ui-checks-grid me-2" aria-hidden="true"></i>카테고리</label>
                <select id="category" name="category" class="form-select" required aria-describedby="categoryHelp">
                  <option value="">선택하세요</option>
                  <option value="General">일반 문의</option>
                  <option value="Collaboration">협업 제안</option>
                  <option value="Speaking">강연/세미나</option>
                </select>
                <div id="categoryHelp" class="invalid-feedback">카테고리를 선택하세요.</div>
              </div>

              <div class="mb-3">
                <label for="message" class="form-label"><i class="bi bi-chat-dots me-2" aria-hidden="true"></i>메시지</label>
                <textarea id="message" name="message" class="form-control" rows="6" required aria-describedby="messageHelp"></textarea>
                <div id="messageHelp" class="invalid-feedback">메시지를 입력하세요.</div>
              </div>

              <div class="d-flex gap-2 justify-content-end pt-1">
                <button id="cancelBtn" class="btn btn-outline-secondary" type="button">취소</button>
                <button id="submitBtn" class="btn btn-primary" type="submit">보내기</button>
              </div>
            </form>

            <!-- NoScript fallback -->
            <noscript>
              <form action="https://formspree.io/f/xnnbodjr" method="POST" class="mt-4">
                <input type="hidden" name="_subject"  value="Portfolio Contact — ai-areum (noscript)">
                <input type="hidden" name="form_name" value="ai-areum-contact-noscript">
                <div class="mb-3">
                  <label class="form-label">Name</label>
                  <input class="form-control" type="text" name="name" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Email</label>
                  <input class="form-control" type="email" name="email" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Message</label>
                  <textarea class="form-control" name="message" rows="5" required></textarea>
                </div>
                <button class="btn btn-primary w-100" type="submit">Send</button>
              </form>
            </noscript>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (no jQuery) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    (function(){
      const form      = document.getElementById('secureForm');
      const submitBtn = document.getElementById('submitBtn');
      const cancelBtn = document.getElementById('cancelBtn');
      const alertBox  = document.getElementById('liveAlert');
      const honeypot  = form.querySelector('input[name="_gotcha"]');

      // hidden fields
      form.elements.source.value = location.href;
      form.elements.ts.value = String(Date.now());

      // helpers
      const setAlert = (type, msg) => {
        alertBox.className = 'alert alert-' + (type === 'success' ? 'success' : 'danger');
        alertBox.textContent = msg;
        alertBox.classList.remove('d-none');
      };
      const clearAlert = () => alertBox.classList.add('d-none');

      // real-time validation
      const fields = ['name','email','category','message'].map(id => form.elements[id]);
      const messages = {
        name: '이름을 입력하세요.',
        email: '올바른 이메일 주소를 입력하세요.',
        category: '카테고리를 선택하세요.',
        message: '메시지를 입력하세요.'
      };
      function validateField(el){
        const valid = el.checkValidity();
        el.classList.toggle('is-invalid', !valid);
        el.setAttribute('aria-invalid', valid ? 'false' : 'true');
        return valid;
      }
      fields.forEach(el=>{
        el.addEventListener('input', ()=> validateField(el));
        el.addEventListener('blur',  ()=> validateField(el));
      });

      // cancel → close or fallback
      cancelBtn.addEventListener('click', ()=>{
        window.close();
        setTimeout(()=>{ if(!window.closed) location.replace('/'); }, 120);
      });

      // submit
      form.addEventListener('submit', (e)=>{
        e.preventDefault();
        clearAlert();

        // honeypot
        if (honeypot && honeypot.value) { setAlert('error','전송이 차단되었습니다.'); return; }

        // validate all
        let firstInvalid = null;
        let allValid = true;
        fields.forEach(el=>{
          if(!validateField(el)) { allValid = false; if(!firstInvalid) firstInvalid = el; }
        });
        form.classList.add('was-validated');
        if(!allValid){ firstInvalid.focus(); return; }

        // disable btn (no visual spinner)
        submitBtn.disabled = true;

        // fire-and-close
        const fd = new FormData(form);
        fd.append('_token', String(Date.now()));
        try{
          fetch(form.action, {
            method:'POST',
            body:fd,
            headers:{'Accept':'application/json'},
            keepalive:true,
            cache:'no-store'
          }).catch(()=>{});
        }catch(_){}

        // close immediately; fallback if not a popup
        window.close();
        setTimeout(()=>{ if(!window.closed) location.replace('/'); }, 60);
      });

      // custom messages for native validity (optional)
      form.addEventListener('invalid', function(e){
        const el = e.target;
        const id = el.getAttribute('id');
        if (id && messages[id]) el.setCustomValidity(messages[id]);
      }, true);
      fields.forEach(el=> el.addEventListener('input', ()=> el.setCustomValidity('')));
    })();
  </script>
</body>
</html>
